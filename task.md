 ## Общая цель

- Создай полностью работающего Telegram-бота под названием «AI-помощник туриста», который помогает пользователю построить индивидуальный маршрут прогулки по Нижнему Новгороду.
Бот должен использовать искусственный интеллект для анализа интересов пользователя и подбора релевантных достопримечательностей на основе предоставленного датасета cultural_objects_mnn.xlsx.

## Входные данные от пользователя

### Бот должен запросить у пользователя:

- Интересы — в свободной текстовой форме, например: “кофейни, стрит-арт, панорамы, архитектура”.

- Количество свободного времени — в часах, например: “3”.

- Текущее местоположение — либо через Telegram-локацию, либо текстом (адрес).

## Ожидаемый результат

### Бот должен отправить пользователю:

- список 3–5 реальных мест, подходящих под интересы;
- оптимальный маршрут (учитывая время и расстояние);
- таймлайн прогулки (расписание по минутам);
- краткие объяснения, почему выбрано каждое место;
- ссылку на визуализацию маршрута (карта с отметками).

## Требования к архитектуре

### Проект на Python 3.10+.

### Использовать следующие библиотеки:

- aiogram
- pandas
- numpy
- sentence-transformers
- geopy
- ortools
- folium
- scikit-learn


### Файловая структура:

/bot/handlers.py        — Telegram-логика (FSM)
/core/recommender.py    — подбор мест по интересам
/core/routing.py        — построение маршрута
/core/geocode.py        — преобразование адресов в координаты
/data/cultural_objects_mnn.xlsx
/models/desc_embeddings.npy
/main.py
requirements.txt

## Этап 1: Подготовка данных

- Загрузить cultural_objects_mnn.xlsx.

### Выделить поля:
- название (name);
- описание (description);
- категория/тип (categories);
- координаты (lat, lon) или адрес (address).
- Если координаты отсутствуют:
- вызвать геокодер Nominatim (OpenStreetMap);
- сохранить координаты в файл processed_objects.parquet.

### Очистить тексты:
- привести к нижнему регистру;
- удалить спецсимволы и HTML;
- убрать дубликаты.

## Этап 2: Создание векторных представлений (эмбеддингов)

- Использовать модель sentence-transformers/all-MiniLM-L6-v2.

- Для каждого места создать текст:

- "{name}. {categories}. {description}"


- Преобразовать эти тексты в эмбеддинги и сохранить в models/desc_embeddings.npy.

- Сохранить идентификаторы строк (models/ids.npy).

## Этап 3: Логика рекомендаций

- При поступлении интересов пользователя:

- вычислить эмбеддинг для текста интересов;

- рассчитать косинусное сходство с эмбеддингами мест;

- выбрать top-30 по схожести.

### Отфильтровать результаты:

- расстояние от текущей точки ≤ 10 км;

- выбрать топ-10 по комбинированному рейтингу: relevance_score = 0.7 * similarity + 0.3 * (1 / distance_km)

## Этап 4: Построение маршрута

- Преобразовать выбранные точки в список координат.

- Создать матрицу расстояний (в минутах), используя: time_min = (distance_km / 4.5) * 60

- Решить задачу коммивояжёра (TSP) через ortools.

- Учитывать ограничение времени прогулки (часы пользователя × 60 минут).

- Вернуть оптимальную последовательность точек.

## Этап 5: Формирование таймлайна

### Для каждой точки добавить:
- время прибытия;
- среднее время осмотра (20 мин);
- переход к следующей точке.


### Построить понятное расписание:

- 10:00 — Старт от вашего местоположения
- 10:15 — Место 1: Площадь Минина (осмотр 20 мин)
- 10:40 — Пешком 12 мин до следующего объекта
...

## Этап 6: Генерация объяснений

### Для каждого места сгенерировать 2–3 предложения:

- "Вы указали интересы: {user_interests}.
- Место {name} выбрано, потому что оно соответствует вашим интересам ({matched_categories})."

- Использовать описание из датасета как контекст.

## Этап 7: Реализация Telegram-бота

### Использовать aiogram и FSM (Finite State Machine):

- /start → приветствие;

- /plan → начало диалога.

### Диалоговые состояния:

- interests → hours → location → результат.


### После получения данных вызвать функцию:

- plan = build_route(interests, hours, start_location)


### Отправить пользователю:

- текст маршрута;

- объяснения;

- изображение карты (folium → PNG).

## Этап 8: Карта маршрута

- Использовать библиотеку folium.

- Построить карту:

- стартовая точка (зелёная);

- остальные точки (синие маркеры);

- соединить их линиями.

- Сохранить как route_map.png и отправить пользователю.

## Этап 9: Финализация

### Добавь requirements.txt с зависимостями.
### Добавь Dockerfile, чтобы можно было запустить:

- docker build -t tourist-bot .
- docker run -e BOT_TOKEN=xxx tourist-bot


### Документация в README.md:

- как запустить;

- пример диалога;

- пример результата.

 Критерии готовности

## Дополнительные указания для ИИ:

- оптимизируй код для скорости отклика (кеш эмбеддингов и геокодирования);

- не используйте внешние платные API, если не задан ключ;

- обеспечь читаемый, модульный код с комментариями;

- все тексты сообщений бота — на русском языке;

- проверяй корректность координат (в пределах Нижнего Новгорода).
